image: $SKA_K8S_TOOLS_DEPLOY_IMAGE

variables:
  MINIKUBE: "false"
  VALUES: "pipeline.yaml"
  CHARTS_TO_PUBLISH: ska-low ska-mid ska-landingpage
  INGRESS_HOST: "k8s.stfc.skao.int"
  GIT_SUBMODULE_STRATEGY: recursive
  SKALLOP_VERSION: "2.19.6"
  K8S_TEST_IMAGE_TO_TEST: artefact.skao.int/ska-ser-skallop:$SKALLOP_VERSION
  KUBE_BRANCH: $CI_JOB_ID
  DOMAIN: "branch"
  CI_BASE_IMAGE_VERSION: "0.1.0-dev.c$CI_COMMIT_SHORT_SHA"
  CI_BASE_IMAGE_NAME: "$CI_REGISTRY/ska-telescope/ska-skampi/ska-skampi-ci-base"
  CI_BASE_IMAGE: "$CI_BASE_IMAGE_NAME:$CI_BASE_IMAGE_VERSION"
  EXPOSE_All_DS: "true"

stages:
  - lint
  - build
  - test
  - scan
  - pages
  - review
  - integration
  - publish
  - staging

# See: https://docs.gitlab.com/ee/ci/yaml/includes.html
include:
  # Common template components
  - local: "/.gitlab/ci/common.gitlab-ci.yml"
  # temp comment out - only test mid
  # # All SKA Low stages
  # - local: "/.gitlab/ci/ska-low.gitlab-ci.yml"
  # All SKA Mid stages
  - local: "/.gitlab/ci/ska-mid.gitlab-ci.yml"
  # Jobs to run on PSI Low
  # - local: "/.gitlab/ci/psi-low.gitlab-ci.yml"
