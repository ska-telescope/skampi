{
  "image": "artefact.skao.int/ska-sdp-realtime-receive-modules",
  "version": "3.6.0",
  "plasmaEnabled": "true",
  "reception": {
    "layout": "/mnt/data/low-layout.json",
    "num_channels": 13824,
    "channels_per_stream": 6912,
    "continuous_mode": "true",
    "transport_protocol": "tcp",
    "payloads_in_flight": 3,
    "disable_astropy_iers_autodownload": "true"
  },
  "pvc": {
    "name": "shared"
  },
  "plasma_parameters": {
    "initContainers": [
      {
        "name": "existing-output-remover",
        "image": "artefact.skao.int/ska-sdp-realtime-receive-processors:0.4.0",
        "command": [
          "rm",
          "-rf",
          "/mnt/data/output*.ms"
        ],
        "volumeMounts": [
          {
            "mountPath": "/mnt/data",
            "name": "shared"
          }
        ]
      },
      {
        "name": "start-telmodel",
        "image": "python:3.10-slim",
        "command": [
          "/bin/bash",
          "-c",
          "pip install --extra-index-url=https://artefact.skao.int/repository/pypi-internal/simple ska-telmodel==1.4.1 pyyaml; rm -f /mnt/data/low-layout.json ; ska-telmodel cat instrument/ska1_low/layout/low-layout.json > /mnt/data/low-layout.json"
        ],
        "volumeMounts": [
          {
            "mountPath": "/mnt/data",
            "name": "shared"
          }
        ]
      }
    ],
    "extraContainers": [
      {
        "name": "plasma-processor",
        "image": "artefact.skao.int/ska-sdp-realtime-receive-processors:0.4.0",
        "args": [
          "--max-payloads",
          "12",
          "--readiness-file",
          "/tmp/processor_ready",
          "output.ms"
        ],
        "volumeMounts": [
          {
            "name": "plasma-storage-volume",
            "mountPath": "/plasma"
          },
          {
            "mountPath": "/mnt/data",
            "name": "shared"
          }
        ],
        "readinessProbe": {
          "initialDelaySeconds": 5,
          "periodSeconds": 5,
          "exec": {
            "command": [
              "cat",
              "/tmp/processor_ready"
            ]
          }
        }
      }
    ]
  }
}
